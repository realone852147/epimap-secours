<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Epita-Map: Trouvez facilement votre salle √† Epita et oubliez les 404 Room Not Found" />
    <meta name="keywords" content="Epimap Epita Map Plan Campus Epitech KB Villejuif" />
    <meta name="author" content="Nathan Chevalier & Mateo S." />
    <meta name="theme-color" content="#0d1230" />
    <title>Epimap</title>
    <link rel="icon" type="image/png" href="img/favicon.png" />

<style>
/* Reset & Base */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: #f5f5f5;
    color: #333;
    overflow-x: hidden;
}

body.darkmode {
    background: #0d1230;
    color: #e0e0e0;
}

/* Header */
header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 2rem;
    background: white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
}

body.darkmode header {
    background: #1a1f3a;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

#btn-menu {
    cursor: pointer;
    display: flex;
    flex-direction: column;
    gap: 5px;
    padding: 8px;
    transition: transform 0.2s;
}

#btn-menu:hover {
    transform: scale(1.1);
}

#btn-menu div {
    width: 28px;
    height: 3px;
    background: #333;
    border-radius: 2px;
    transition: 0.3s;
}

body.darkmode #btn-menu div {
    background: #e0e0e0;
}

header input[type="text"] {
    flex: 1;
    padding: 0.75rem 1rem;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    outline: none;
    transition: border 0.2s;
}

header input[type="text"]:focus {
    border-color: #0066cc;
}

body.darkmode header input[type="text"] {
    background: #2a2f4a;
    border-color: #3a3f5a;
    color: #e0e0e0;
}

header button {
    padding: 0.75rem 1.5rem;
    background: #0066cc;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.2s;
}

header button:hover {
    background: #0052a3;
}

header button::before {
    content: "üîç";
}

/* Settings Button */
#btn-settings {
    position: fixed;
    top: 6rem;
    right: 2rem;
    width: 50px;
    height: 50px;
    background: #0066cc;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    z-index: 99;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
}

#btn-settings:hover {
    transform: scale(1.1);
}

#btn-settings::before {
    content: "‚öôÔ∏è";
    font-size: 1.5rem;
}

/* Navigation Menu */
#nav-menu {
    position: fixed;
    left: -400px;
    top: 0;
    width: 380px;
    height: 100vh;
    background: white;
    box-shadow: 2px 0 12px rgba(0,0,0,0.15);
    padding: 2rem;
    transition: left 0.3s ease;
    z-index: 101;
    overflow-y: auto;
}

body.darkmode #nav-menu {
    background: #1a1f3a;
}

#nav-menu.active {
    left: 0;
}

#nav-menu ul {
    list-style: none;
}

#nav-menu > ul > li {
    margin-bottom: 1rem;
}

#nav-menu a {
    display: block;
    padding: 0.75rem 1rem;
    color: #333;
    text-decoration: none;
    border-radius: 6px;
    transition: background 0.2s;
    font-weight: 500;
}

body.darkmode #nav-menu a {
    color: #e0e0e0;
}

#nav-menu a.menu-itm-campus {
    background: #0066cc;
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

#nav-menu a.menu-itm-campus:hover {
    background: #0052a3;
}

#nav-menu a.menu-itm-building {
    background: #f0f0f0;
    font-weight: 600;
    margin-left: 1rem;
    margin-top: 0.5rem;
}

body.darkmode #nav-menu a.menu-itm-building {
    background: #2a2f4a;
}

#nav-menu a.menu-itm-building:hover {
    background: #e0e0e0;
}

body.darkmode #nav-menu a.menu-itm-building:hover {
    background: #3a3f5a;
}

#nav-menu a.menu-itm-stage {
    background: transparent;
    margin-left: 2rem;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
}

#nav-menu a.menu-itm-stage:hover {
    background: #f9f9f9;
}

body.darkmode #nav-menu a.menu-itm-stage:hover {
    background: #2a2f4a;
}

#nav-menu ul ul {
    margin-top: 0.5rem;
}

#infooter {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid #ddd;
    font-size: 0.85rem;
    color: #666;
    line-height: 1.6;
}

body.darkmode #infooter {
    border-color: #3a3f5a;
    color: #999;
}

#infooter a {
    color: #0066cc;
    text-decoration: none;
}

#infooter a:hover {
    text-decoration: underline;
}

/* Settings Panel */
#settings {
    position: fixed;
    right: -400px;
    top: 0;
    width: 380px;
    height: 100vh;
    background: white;
    box-shadow: -2px 0 12px rgba(0,0,0,0.15);
    padding: 2rem;
    transition: right 0.3s ease;
    z-index: 101;
    overflow-y: auto;
}

body.darkmode #settings {
    background: #1a1f3a;
}

#settings.active {
    right: 0;
}

#settings h3 {
    margin-bottom: 2rem;
    font-size: 1.5rem;
}

.setting {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: #f9f9f9;
    border-radius: 8px;
}

body.darkmode .setting {
    background: #2a2f4a;
}

.setting select {
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 6px;
    background: white;
    color: #333;
    cursor: pointer;
}

body.darkmode .setting select {
    background: #1a1f3a;
    border-color: #3a3f5a;
    color: #e0e0e0;
}

#settings > span {
    display: block;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #ddd;
    font-size: 0.85rem;
    color: #666;
    line-height: 1.6;
}

body.darkmode #settings > span {
    border-color: #3a3f5a;
    color: #999;
}

#settings a {
    color: #0066cc;
    text-decoration: none;
}

#settings a:hover {
    text-decoration: underline;
}

/* Toggle Switch */
.onoffswitch {
    position: relative;
    width: 60px;
}

.onoffswitch-checkbox {
    position: absolute;
    opacity: 0;
    pointer-events: none;
}

.onoffswitch-label {
    display: block;
    overflow: hidden;
    cursor: pointer;
    height: 30px;
    padding: 0;
    line-height: 30px;
    border-radius: 30px;
    background-color: #ccc;
    transition: background-color 0.3s ease-in;
}

.onoffswitch-label:before {
    content: "";
    display: block;
    width: 26px;
    height: 26px;
    margin: 2px;
    background: white;
    position: absolute;
    top: 0;
    bottom: 0;
    right: 28px;
    border-radius: 50%;
    transition: all 0.3s ease-in 0s;
}

.onoffswitch-checkbox:checked + .onoffswitch-label {
    background-color: #0066cc;
}

.onoffswitch-checkbox:checked + .onoffswitch-label:before {
    right: 2px;
}

/* Container & Map */
#container {
    width: 100%;
    height: calc(100vh - 80px);
    min-height: 600px;
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    position: relative;
}

body.darkmode #container {
    background: #0d1230;
}

#container.darkmap {
    background: #0d1230;
}

#container svg {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

/* Info Menu */
#info-menu {
    position: fixed;
    right: -420px;
    top: 0;
    width: 400px;
    height: 100vh;
    background: white;
    box-shadow: -2px 0 12px rgba(0,0,0,0.15);
    padding: 2rem;
    transition: right 0.3s ease;
    z-index: 101;
    overflow-y: auto;
}

body.darkmode #info-menu {
    background: #1a1f3a;
}

#info-menu.active {
    right: 0;
}

#info-menu h4 {
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
}

#info-menu h5 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

#info-menu span {
    color: #666;
    font-size: 0.9rem;
}

body.darkmode #info-menu span {
    color: #999;
}

.search-result {
    padding: 1rem;
    background: #f9f9f9;
    border-radius: 8px;
    margin-bottom: 1rem;
    cursor: pointer;
    transition: background 0.2s;
}

body.darkmode .search-result {
    background: #2a2f4a;
}

.search-result:hover {
    background: #e0e0e0;
}

body.darkmode .search-result:hover {
    background: #3a3f5a;
}

.search-result h4 {
    margin-bottom: 0.5rem;
}

/* Map Label */
#map-label {
    position: fixed;
    bottom: 2rem;
    left: 2rem;
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
    display: none;
    align-items: center;
    gap: 1rem;
}

body.darkmode #map-label {
    background: #1a1f3a;
}

#map-label.active {
    display: flex;
}

.map-icon {
    width: 40px;
    height: 40px;
    background: #0066cc;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.map-icon::before {
    content: "üìç";
    font-size: 1.5rem;
}

/* Footer */
footer {
    padding: 2rem;
    text-align: center;
    background: white;
    border-top: 1px solid #ddd;
    font-size: 0.9rem;
    color: #666;
}

body.darkmode footer {
    background: #1a1f3a;
    border-color: #3a3f5a;
    color: #999;
}

footer a {
    color: #0066cc;
    text-decoration: none;
}

footer a:hover {
    text-decoration: underline;
}

/* Cache */
#cache {
    display: none;
}

/* Legal Pages */
.legal-page {
    max-width: 900px;
    margin: 3rem auto;
    padding: 2rem;
    background: white !important;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.1);
    color: #111 !important;
}

.legal-page h1 {
    font-size: 2rem;
    margin-bottom: 1.5rem;
    color: #0066cc;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.legal-page h1 svg {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
}

.legal-page h2 {
    font-size: 1.5rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
    color: #333;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.legal-page h2 svg {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
}

.legal-page p {
    line-height: 1.8;
    margin-bottom: 1rem;
    color: #111;
}

.legal-page ul {
    margin-left: 2rem;
    margin-bottom: 1rem;
    line-height: 1.8;
}

.legal-page li {
    margin-bottom: 0.5rem;
    color: #111;
}

.legal-page a {
    color: #0066cc;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

.legal-page a:hover {
    text-decoration: underline;
}

.legal-page a svg {
    width: 14px;
    height: 14px;
}

.legal-page .info-box {
    padding: 1rem;
    margin-bottom: 1rem;
    background: #e8f4fd;
    border-left: 4px solid #0066cc;
    border-radius: 4px;
}

.legal-page .warning-box {
    padding: 1rem;
    margin-bottom: 1rem;
    background: #fff3cd;
    border-left: 4px solid #ffc107;
    border-radius: 4px;
}

.legal-page .btn-back {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 2rem;
    padding: 0.75rem 2rem;
    background: #0066cc;
    color: white !important;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    text-decoration: none;
    transition: background 0.2s;
}

.legal-page .btn-back:hover {
    background: #0052a3;
}

.legal-page .btn-back svg {
    width: 18px;
    height: 18px;
}

.legal-page em {
    color: #666;
}

.legal-page .contact-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.legal-page .contact-info svg {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
}

/* Responsive Legal Pages */
@media (max-width: 1024px) {
    .legal-page {
        margin: 2rem auto;
        max-width: 95%;
    }
}

@media (max-width: 768px) {
    header {
        padding: 0.75rem 1rem;
        flex-wrap: wrap;
    }

    header input[type="text"] {
        width: 100%;
        order: 3;
        margin-top: 0.5rem;
    }

    #nav-menu, #settings, #info-menu {
        width: 90%;
        max-width: 350px;
    }

    #nav-menu {
        left: -100%;
    }

    #settings, #info-menu {
        right: -100%;
    }

    #btn-settings {
        right: 1rem;
        width: 45px;
        height: 45px;
    }

    #container {
        height: calc(100vh - 120px);
    }

    .legal-page {
        margin: 1rem;
        padding: 1.5rem;
    }

    .legal-page h1 {
        font-size: 1.5rem;
    }

    .legal-page h1 svg {
        width: 28px;
        height: 28px;
    }

    .legal-page h2 {
        font-size: 1.2rem;
        margin-top: 1.5rem;
    }

    .legal-page h2 svg {
        width: 20px;
        height: 20px;
    }

    .legal-page ul {
        margin-left: 1.5rem;
    }

    .legal-page .btn-back {
        width: 100%;
        justify-content: center;
        padding: 0.875rem 1.5rem;
    }
}

@media (max-width: 480px) {
    .legal-page {
        margin: 0.5rem;
        padding: 1rem;
        border-radius: 8px;
    }

    .legal-page h1 {
        font-size: 1.3rem;
        flex-wrap: wrap;
    }

    .legal-page h2 {
        font-size: 1.1rem;
        flex-wrap: wrap;
    }

    .legal-page p {
        font-size: 0.95rem;
    }

    .legal-page ul {
        margin-left: 1rem;
        font-size: 0.95rem;
    }

    .legal-page .info-box,
    .legal-page .warning-box {
        padding: 0.75rem;
        font-size: 0.9rem;
    }

    .legal-page .contact-info {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
    }
}

/* Loading Spinner */
.loading {
    display: inline-block;
    width: 50px;
    height: 50px;
    border: 4px solid rgba(0,102,204,0.2);
    border-radius: 50%;
    border-top-color: #0066cc;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}
</style>
</head>

<body class="darkmode">

<header>
    <div id="btn-menu">
        <div></div>
        <div></div>
        <div></div>
    </div>
    <input type="text" name="search" placeholder="Rechercher une salle, une personne..." />
    <button></button>
</header>

<div id="btn-settings"></div>

<nav id="info-menu">
    <div>
        <div></div>
        <div>
            <h4>Nom de la salle</h4>
            <span>Description de la salle</span>
            <div>
                <div></div>
                <div>
                    <h5>Nom de la personne</h5>
                    <span>Description de la personne</span>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div id="search-result-template" class="search-result">
            <h4></h4>
            <span></span>
        </div>
    </div>
</nav>

<nav id="nav-menu">
    <div style="padding: 1rem; margin-bottom: 1rem; background: rgba(0,102,204,0.1); border-radius: 8px; font-size: 0.85rem;">
        <strong>‚ÑπÔ∏è Navigation</strong><br>
        Cliquez sur un campus puis sur un √©tage pour afficher le plan
    </div>
    <ul>
        <li><a href="#kb" class="menu-itm-campus" data-map="maps/kb.svg">üè´ Kremlin-Bic√™tre</a>
            <ul>
                <li><a href="#voltaire" class="menu-itm-building">Voltaire</a>
                    <ul>
                        <li><a href="#kb-v-1" class="menu-itm-stage" data-map="maps/kb-voltaire-f-1.svg">Voltaire Sous-sol</a></li>
                        <li><a href="#kb-v0" class="menu-itm-stage" data-map="maps/kb-voltaire-f0.svg">Voltaire RdC</a></li>
                        <li><a href="#kb-v1" class="menu-itm-stage" data-map="maps/kb-voltaire-f1.svg">Voltaire 1er √©tage</a></li>
                        <li><a href="#kb-v2" class="menu-itm-stage" data-map="maps/kb-voltaire-f2.svg">Voltaire 2√®me √©tage</a></li>
                        <li><a href="#kb-v3" class="menu-itm-stage" data-map="maps/kb-voltaire-f3.svg">Voltaire 3√®me √©tage</a></li>
                        <li><a href="#kb-v4" class="menu-itm-stage" data-map="maps/kb-voltaire-f4.svg">Voltaire 4√®me √©tage</a></li>
                        <li><a href="#kb-v5" class="menu-itm-stage" data-map="maps/kb-voltaire-f5.svg">Voltaire 5√®me √©tage</a></li>
                        <li><a href="#kb-v6" class="menu-itm-stage" data-map="maps/kb-voltaire-f6.svg">Voltaire 6√®me √©tage</a></li>
                    </ul>
                </li>
                <li><a href="#paritalie" class="menu-itm-building">Paritalie</a>
                    <ul>
                        <li><a href="#kb-p0" class="menu-itm-stage" data-map="maps/kb-paritalie-f0.svg">Paritalie RdC</a></li>
                        <li><a href="#kb-p1" class="menu-itm-stage" data-map="maps/kb-paritalie-f1.svg">Paritalie 1er √©tage</a></li>
                        <li><a href="#kb-p2" class="menu-itm-stage" data-map="maps/kb-paritalie-f2.svg">Paritalie 2√®me √©tage</a></li>
                        <li><a href="#kb-p3" class="menu-itm-stage" data-map="maps/kb-paritalie-f3.svg">Paritalie 3√®me √©tage</a></li>
                        <li><a href="#kb-p4" class="menu-itm-stage" data-map="maps/kb-paritalie-f4.svg">Paritalie 4√®me √©tage</a></li>
                        <li><a href="#kb-p5" class="menu-itm-stage" data-map="maps/kb-paritalie-f5.svg">Paritalie 5√®me √©tage</a></li>
                    </ul>
                </li>
                <li><a href="#pasteur" class="menu-itm-building">Pasteur</a>
                    <ul>
                        <li><a href="#kb-pa-2" class="menu-itm-stage" data-map="maps/kb-pasteur-f-2.svg">Pasteur -2 (Under)</a></li>
                        <li><a href="#kb-pa-1" class="menu-itm-stage" data-map="maps/kb-pasteur-f-1.svg">Pasteur -1 (Inter-sol)</a></li>
                        <li><a href="#kb-pa0" class="menu-itm-stage" data-map="maps/kb-pasteur-f0.svg">Pasteur RdC</a></li>
                        <li><a href="#kb-pa1" class="menu-itm-stage" data-map="maps/kb-pasteur-f1.svg">Pasteur 1er √©tage</a></li>
                        <li><a href="#kb-pa2" class="menu-itm-stage" data-map="maps/kb-pasteur-f2.svg">Pasteur 2√®me √©tage</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li><a href="#vj" class="menu-itm-campus" data-map="maps/vj.svg">üè´ Villejuif</a>
            <ul>
                <li><a href="#va" class="menu-itm-building">VA</a>
                    <ul>
                        <li><a href="#vj-va-1" class="menu-itm-stage" data-map="maps/vj-va-f-1.svg">VA Sous-sol</a></li>
                        <li><a href="#vj-va0" class="menu-itm-stage" data-map="maps/vj-va-f0.svg">VA RdC</a></li>
                        <li><a href="#vj-va1" class="menu-itm-stage" data-map="maps/vj-va-f1.svg">VA 1er √©tage</a></li>
                        <li><a href="#vj-va2" class="menu-itm-stage" data-map="maps/vj-va-f2.svg">VA 2√®me √©tage</a></li>
                        <li><a href="#vj-va3" class="menu-itm-stage" data-map="maps/vj-va-f3.svg">VA 3√®me √©tage</a></li>
                    </ul>
                </li>
                <li><a href="#vb" class="menu-itm-building">VB</a>
                    <ul>
                        <li><a href="#vj-vb0" class="menu-itm-stage">VB 0 (Bient√¥t)</a></li>
                        <li><a href="#vj-vb1" class="menu-itm-stage">VB 1 (Bient√¥t)</a></li>
                    </ul>
                </li>
                <li><a href="#vjc" class="menu-itm-building">VJC</a>
                    <ul>
                        <li><a href="#vj-vjc0b" class="menu-itm-stage" data-map="maps/vj-vjc-f0b.svg">VJC RdC Bas</a></li>
                        <li><a href="#vj-vjc0h" class="menu-itm-stage" data-map="maps/vj-vjc-f0h.svg">VJC RdC Haut</a></li>
                        <li><a href="#vj-vjc1" class="menu-itm-stage" data-map="maps/vj-vjc-f1.svg">VJC 1er √©tage</a></li>
                        <li><a href="#vj-vjc2" class="menu-itm-stage" data-map="maps/vj-vjc-f2.svg">VJC 2√®me √©tage</a></li>
                        <li><a href="#vj-vjc3" class="menu-itm-stage" data-map="maps/vj-vjc-f3.svg">VJC 3√®me √©tage</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li><a href="#lyon" class="menu-itm-campus">üè´ Lyon</a>
            <ul>
                <li><a href="#lyon1" class="menu-itm-building">Lyon (Bient√¥t)</a></li>
            </ul>
        </li>

        <li><a href="#toulouse" class="menu-itm-campus">üè´ Toulouse</a>
            <ul>
                <li><a href="#tlse" class="menu-itm-building">Toulouse (Bient√¥t)</a></li>
            </ul>
        </li>

        <li><a href="#special" class="menu-itm-campus">‚≠ê SP√âCIALES</a>
            <ul>
                <li><a href="#events" class="menu-itm-building">√âv√©nements</a>
                    <ul>
                        <li><a href="#prologin2025" class="menu-itm-stage" data-map="maps/others-prologin-f2025.svg">Finale Prologin 2025</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <div id="infooter">
            <strong style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 20px; height: 20px;">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="16" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
                Informations l√©gales
            </strong>
            
            <p style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                    <polyline points="22,6 12,13 2,6"/>
                </svg>
                Responsable : <a href="mailto:mateo.schwab@epita.fr">mateo.schwab@epita.fr</a>
            </p>
            <p style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                    <polyline points="16 18 22 12 16 6"/>
                    <polyline points="8 6 2 12 8 18"/>
                </svg>
                D√©veloppeur : <a href="mailto:nathan.chevalier@epita.fr">nathan.chevalier@epita.fr</a>
            </p>
            
            <div style="margin-bottom: 1rem;">
                <a href="#" id="privacy-link" style="color: #0066cc; text-decoration: none; display: inline-flex; align-items: center; gap: 0.25rem; margin-right: 1rem;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                    </svg>
                    Confidentialit√©
                </a>
                <a href="#" id="mentions-link" style="color: #0066cc; text-decoration: none; display: inline-flex; align-items: center; gap: 0.25rem;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    Mentions l√©gales
                </a>
            </div>
            
            <p style="display: flex; align-items: flex-start; gap: 0.5rem; margin-bottom: 1rem; font-size: 0.9rem;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-top: 0.2rem; flex-shrink: 0;">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                <span><strong>Projet √©tudiant ind√©pendant</strong>, non affili√© √† IONIS Education Group. Les plans sont fournis √† titre indicatif.</span>
            </p>
            
            <p style="font-size: 0.85rem; color: #999;">
                Hosted with ‚ù§Ô∏è by Mateo S.
            </p>
            <p style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;">
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
                </svg>
                <a href="https://github.com/realone852147/epimap-secours" target="_blank">Contribute on GitHub</a>
            </p>
        </div>
    </ul>
</nav>

<section id="settings">
    <h3>Param√®tres</h3>
    <div class="setting">
        <span>Mode Sombre</span>
        <div class="onoffswitch">
            <input type="checkbox" name="darkmodeSwitch" class="onoffswitch-checkbox" id="darkmodeSwitch" tabindex="0" checked>
            <label class="onoffswitch-label" for="darkmodeSwitch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
            </label>
        </div>
    </div>
    <div class="setting">
        <span>Enrichir l'affichage</span>
        <div class="onoffswitch">
            <input type="checkbox" name="enrichedSwitch" class="onoffswitch-checkbox" id="enrichedSwitch" tabindex="0">
            <label class="onoffswitch-label" for="enrichedSwitch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
            </label>
        </div>
    </div>
    <div class="setting">
        <span>Langue</span>
        <select>
            <option value="fr">FR</option>
            <option value="en">EN</option>
        </select>
    </div>
    <span>
        <strong>üìß Contact</strong><br>
        Responsable : mateo.schwab@epita.fr<br />
        D√©veloppeur : nathan.chevalier@epita.fr<br /><br />
        
        <strong>üîí Confidentialit√©</strong><br>
        Ce site ne collecte aucune donn√©e personnelle.<br>
        <a href="#" id="settings-privacy-link">Voir la politique compl√®te</a><br><br>
        
        Hosted with üíñ by Mateo S.<br />
        <a href="https://github.com/realone852147/epimap-secours" target="_blank">Contribute on GitHub</a>
    </span>
</section>

<section id="cache"><div></div></section>

<section id="container" class="darkmap" contenturl="maps/kb.svg">
    <div style="text-align: center; padding: 2rem;">
        <div class="loading"></div>
        <p style="margin-top: 1rem;">Chargement de la carte...</p>
        <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">S√©lectionnez un √©tage dans le menu</p>
    </div>
</section>

<section id="map-label">
    <div class="map-icon"></div>
    <div>
        <div>Information</div>
    </div>
</section>

<footer>
    <p style="line-height: 1.8;">
        <strong>Epita-Map.fr</strong> ‚Äî Projet √©tudiant ind√©pendant, non affili√© √† IONIS Education Group<br>
        <a href="#" id="footer-privacy-link">üìÑ Politique de confidentialit√©</a> | 
        <a href="#" id="footer-mentions-link">‚öñÔ∏è Mentions l√©gales</a> | 
        <a href="https://github.com/realone852147/epimap-secours" target="_blank">üíª GitHub</a><br>
        Responsable: Mateo S. | D√©veloppeur: Nathan C. | Hosted with üíñ
    </p>
    <div class="log-box" style="display: none"><div>X</div></div>
</footer>

<script>
// Main Application
document.addEventListener("DOMContentLoaded", () => {
    const body = document.body;
    const btnMenu = document.getElementById("btn-menu");
    const btnSettings = document.getElementById("btn-settings");
    const navMenu = document.getElementById("nav-menu");
    const settings = document.getElementById("settings");
    const infoMenu = document.getElementById("info-menu");
    const container = document.getElementById("container");
    const darkmodeSwitch = document.getElementById("darkmodeSwitch");
    const enrichedSwitch = document.getElementById("enrichedSwitch");
    const searchInput = document.querySelector('input[name="search"]');
    const searchBtn = document.querySelector('header button');

    // Toggle Menu
    btnMenu.addEventListener("click", () => {
        navMenu.classList.toggle("active");
        settings.classList.remove("active");
        infoMenu.classList.remove("active");
    });

    // Toggle Settings
    btnSettings.addEventListener("click", () => {
        settings.classList.toggle("active");
        navMenu.classList.remove("active");
        infoMenu.classList.remove("active");
    });

    // Dark Mode Toggle
    darkmodeSwitch.addEventListener("change", () => {
        body.classList.toggle("darkmode");
        container.classList.toggle("darkmap");
        localStorage.setItem('darkmode', body.classList.contains('darkmode'));
    });

    // Load Dark Mode Preference
    const savedDarkMode = localStorage.getItem('darkmode');
    if (savedDarkMode === 'false') {
        body.classList.remove('darkmode');
        container.classList.remove('darkmap');
        darkmodeSwitch.checked = false;
    }

    // Enriched Display Toggle
    enrichedSwitch.addEventListener("change", () => {
        const enriched = enrichedSwitch.checked;
        localStorage.setItem('enriched', enriched);
        console.log('Enriched display:', enriched);
    });

    // Load SVG Map
    async function loadMap(mapUrl) {
        if (!mapUrl) return;
        
        // Store function globally for legal page return
        window.loadMapFunction = loadMap;
        
        container.innerHTML = `
            <div style="text-align: center; padding: 2rem;">
                <div class="loading"></div>
                <p style="margin-top: 1rem;">Chargement de ${mapUrl}...</p>
            </div>
        `;

        try {
            const response = await fetch(mapUrl);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const svgText = await response.text();
            container.innerHTML = svgText;
            
            // Add interactivity to SVG elements
            const svg = container.querySelector('svg');
            if (svg) {
                svg.style.width = '100%';
                svg.style.height = '100%';
                svg.style.maxWidth = '100%';
                svg.style.maxHeight = '100%';
                
                // Add white background with 10px padding around SVG
                container.style.background = 'white';
                container.style.padding = '10px';
                
                // Make SVG interactive
                const rooms = svg.querySelectorAll('[id*="room"], [class*="room"], rect, path, polygon');
                rooms.forEach(room => {
                    room.style.cursor = 'pointer';
                    room.addEventListener('click', (e) => {
                        const roomId = e.target.id || e.target.getAttribute('data-room');
                        if (roomId) {
                            showRoomInfo(roomId, e.target);
                        }
                    });
                    
                    room.addEventListener('mouseenter', (e) => {
                        e.target.style.opacity = '0.7';
                        e.target.style.transition = 'opacity 0.2s';
                    });
                    
                    room.addEventListener('mouseleave', (e) => {
                        e.target.style.opacity = '1';
                    });
                });
            }
        } catch (error) {
            console.error('Error loading map:', error);
            // Reset container background on error
            container.style.background = '';
            container.style.padding = '';
            container.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #d32f2f;">
                    <h3>‚ùå Erreur de chargement</h3>
                    <p style="margin-top: 1rem;">Impossible de charger la carte: ${mapUrl}</p>
                    <p style="font-size: 0.9rem; margin-top: 0.5rem; color: #666;">
                        ${error.message}
                    </p>
                    <p style="font-size: 0.85rem; margin-top: 1rem; color: #999;">
                        Assurez-vous que le fichier SVG existe dans le dossier maps/
                    </p>
                </div>
            `;
        }
    }

    // Show Room Information
    function showRoomInfo(roomId, element) {
        const roomName = roomId || 'Salle inconnue';
        const roomDesc = element.getAttribute('data-description') || 'Aucune description disponible';
        
        infoMenu.querySelector('h4').textContent = roomName;
        infoMenu.querySelector('span').textContent = roomDesc;
        
        infoMenu.classList.add('active');
        navMenu.classList.remove('active');
        settings.classList.remove('active');
        
        // Highlight selected room
        document.querySelectorAll('svg [style*="stroke"]').forEach(el => {
            el.style.stroke = '';
            el.style.strokeWidth = '';
        });
        element.style.stroke = '#0066cc';
        element.style.strokeWidth = '3';
    }

    // Handle Map Navigation
    document.querySelectorAll('.menu-itm-stage, .menu-itm-campus').forEach(link => {
        link.addEventListener('click', async (e) => {
            e.preventDefault();
            const mapUrl = link.getAttribute('data-map');
            if (mapUrl) {
                await loadMap(mapUrl);
                navMenu.classList.remove('active');
                
                // Update URL hash
                window.location.hash = link.getAttribute('href');
            }
        });
    });

    // Building links (accordion behavior)
    document.querySelectorAll('.menu-itm-building').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const ul = link.nextElementSibling;
            if (ul && ul.tagName === 'UL') {
                ul.style.display = ul.style.display === 'none' ? 'block' : 'none';
            }
        });
    });

    // Search Functionality
    function performSearch() {
        const query = searchInput.value.trim().toLowerCase();
        if (!query) return;

        // Reset container background
        container.style.background = '';
        container.style.padding = '';

        const results = [];
        document.querySelectorAll('.menu-itm-stage').forEach(link => {
            const text = link.textContent.toLowerCase();
            if (text.includes(query)) {
                results.push({
                    name: link.textContent,
                    map: link.getAttribute('data-map'),
                    link: link
                });
            }
        });

        if (results.length > 0) {
            displaySearchResults(results);
        } else {
            container.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h3>üîç Aucun r√©sultat</h3>
                    <p style="margin-top: 1rem;">Aucune salle trouv√©e pour "${query}"</p>
                </div>
            `;
        }
    }

    function displaySearchResults(results) {
        // Reset container background when showing search results
        container.style.background = '';
        container.style.padding = '';
        
        infoMenu.innerHTML = `
            <h3 style="margin-bottom: 1.5rem;">R√©sultats de recherche (${results.length})</h3>
        `;
        
        results.forEach(result => {
            const div = document.createElement('div');
            div.className = 'search-result';
            div.innerHTML = `
                <h4>${result.name}</h4>
                <span>Cliquez pour afficher</span>
            `;
            div.addEventListener('click', async () => {
                if (result.map) {
                    await loadMap(result.map);
                    infoMenu.classList.remove('active');
                }
            });
            infoMenu.appendChild(div);
        });
        
        infoMenu.classList.add('active');
    }

    searchBtn.addEventListener('click', performSearch);
    searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            performSearch();
        }
    });

    // Close menus on outside click
    document.addEventListener('click', (e) => {
        if (!navMenu.contains(e.target) && !btnMenu.contains(e.target)) {
            navMenu.classList.remove('active');
        }
        if (!settings.contains(e.target) && !btnSettings.contains(e.target)) {
            settings.classList.remove('active');
        }
        if (!infoMenu.contains(e.target) && 
            !searchBtn.contains(e.target) && 
            !searchInput.contains(e.target)) {
            // Don't close info menu on outside click if it has content
        }
    });

    // Close menus on ESC key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            navMenu.classList.remove('active');
            settings.classList.remove('active');
            infoMenu.classList.remove('active');
        }
    });

    // Load initial map if hash present
    if (window.location.hash) {
        const link = document.querySelector(`a[href="${window.location.hash}"]`);
        if (link) {
            const mapUrl = link.getAttribute('data-map');
            if (mapUrl) {
                loadMap(mapUrl);
            }
        }
    } else {
        // Load default map
        const defaultMap = container.getAttribute('contenturl');
        if (defaultMap) {
            loadMap(defaultMap);
        }
    }

    // Initialize building submenus as collapsed
    document.querySelectorAll('.menu-itm-building + ul').forEach(ul => {
        ul.style.display = 'none';
    });

    console.log('‚úÖ Epita-Map initialized successfully');
});

// Legal Pages Content
const legalPages = {
    privacy: `
        <div class="legal-page">
            <h1>üìÑ Politique de confidentialit√©</h1>
            
            <div class="info-box">
                <p style="font-size: 1.1rem; margin: 0;">
                    <strong>Epita-Map.fr</strong> ne collecte, ne stocke et ne partage <strong>aucune donn√©e personnelle</strong>.
                </p>
            </div>

            <h2>1. üîç Donn√©es collect√©es</h2>
            <ul>
                <li><strong>Aucune g√©olocalisation</strong> automatique ou manuelle n'est effectu√©e</li>
                <li><strong>Aucun compte utilisateur</strong> n'est requis pour utiliser le service</li>
                <li><strong>Aucun cookie de suivi</strong> ou de tra√ßage n'est utilis√©</li>
                <li><strong>Aucune analyse comportementale</strong> (pas de Google Analytics, Facebook Pixel, etc.)</li>
                <li>Les <strong>adresses IP ne sont pas visibles</strong> par notre serveur (tout le trafic passe via Cloudflare)</li>
            </ul>

            <h2>2. üõ°Ô∏è S√©curit√© et infrastructure</h2>
            <p>Le site est prot√©g√© par <strong>Cloudflare</strong> qui assure :</p>
            <ul>
                <li>Chiffrement HTTPS pour toutes les communications</li>
                <li>Protection anti-DDoS</li>
                <li>Cache de contenu pour am√©liorer les performances</li>
            </ul>
            <div class="warning-box">
                <p style="margin: 0;">
                    ‚ö†Ô∏è <strong>Note importante :</strong> Le trafic passe via Cloudflare pour des raisons de s√©curit√©. 
                    Ce service peut traiter les adresses IP conform√©ment √† sa propre politique de confidentialit√© 
                    accessible sur <a href="https://www.cloudflare.com/fr-fr/privacypolicy/" target="_blank">cloudflare.com/privacypolicy</a>.
                </p>
            </div>

            <h2>3. üíæ Conservation des donn√©es</h2>
            <p><strong>Aucune donn√©e n'est conserv√©e de mani√®re persistante.</strong> Les seuls logs techniques g√©n√©r√©s sont :</p>
            <ul>
                <li>Anonymes (aucune IP visible)</li>
                <li>Temporaires (r√©tention de quelques jours maximum)</li>
                <li>Utilis√©s uniquement pour diagnostiquer les probl√®mes techniques</li>
            </ul>

            <h2>4. üç™ Cookies et stockage local</h2>
            <p>Le site utilise uniquement le <strong>localStorage</strong> de votre navigateur pour sauvegarder vos pr√©f√©rences locales :</p>
            <ul>
                <li>Mode sombre activ√©/d√©sactiv√©</li>
                <li>Pr√©f√©rence d'affichage enrichi</li>
            </ul>
            <p><em>Ces donn√©es restent sur votre appareil et ne sont jamais transmises √† nos serveurs.</em></p>

            <h2>5. üîó Liens externes</h2>
            <p>Ce site peut contenir des liens vers des sites externes (GitHub, Cloudflare). Nous ne sommes pas responsables de leurs politiques de confidentialit√©.</p>

            <h2>6. ‚úâÔ∏è Contact</h2>
            <p>
                Pour toute question concernant cette politique de confidentialit√© :<br>
                üìß Responsable : <a href="mailto:mateo.schwab@epita.fr">mateo.schwab@epita.fr</a><br>
                üìß D√©veloppeur : <a href="mailto:nathan.chevalier@epita.fr">nathan.chevalier@epita.fr</a>
            </p>

            <p><em>Derni√®re mise √† jour : Octobre 2024</em></p>

            <button class="btn-back" id="close-legal">‚Üê Retour √† la carte</button>
        </div>
    `,
    
    mentions: `
        <div class="legal-page">
            <h1>‚öñÔ∏è Mentions l√©gales</h1>

            <h2>1. üìù √âditeur du site</h2>
            <p>
                <strong>Nom du site :</strong> Epita-Map.fr<br>
                <strong>Nature :</strong> Projet √©tudiant b√©n√©vole<br>
                <strong>Responsable de publication :</strong> Mateo Schwab<br>
                <strong>Contact :</strong> <a href="mailto:mateo.schwab@epita.fr">mateo.schwab@epita.fr</a><br>
                <strong>D√©veloppeur :</strong> Nathan Chevalier (source du code)<br>
                <strong>Contact d√©veloppeur :</strong> <a href="mailto:nathan.chevalier@epita.fr">nathan.chevalier@epita.fr</a>
            </p>

            <h2>2. üñ•Ô∏è H√©bergement</h2>
            <p>
                <strong>H√©bergeur :</strong> Proxmox Local (Serveur priv√©)<br>
                <strong>Adresse :</strong> Non communiqu√©e (h√©bergement priv√©)<br>
                <strong>Protection CDN :</strong> Cloudflare, Inc.<br>
                101 Townsend St, San Francisco, CA 94107, USA<br>
                <a href="https://www.cloudflare.com" target="_blank">www.cloudflare.com</a>
            </p>

            <h2>3. üéØ Objet du site</h2>
            <p>
                Epita-Map.fr a pour objectif de fournir aux √©tudiants et visiteurs de l'EPITA un acc√®s 
                simplifi√© aux plans des diff√©rents campus de l'√©cole. Ce projet est <strong>ind√©pendant</strong> 
                et <strong>non affili√©</strong> √† IONIS Education Group ou √† l'EPITA.
            </p>

            <h2>4. üìú Propri√©t√© intellectuelle</h2>
            <div class="warning-box">
                <p style="margin: 0;">
                    ‚ö†Ô∏è <strong>Disclaimer important :</strong><br>
                    ‚Ä¢ Les plans de campus appartiennent √† l'EPITA / IONIS Education Group<br>
                    ‚Ä¢ Ce site est un projet √©tudiant utilisant ces plans √† des fins <strong>√©ducatives et pratiques</strong><br>
                    ‚Ä¢ Aucune utilisation commerciale n'est faite de ces contenus<br>
                    ‚Ä¢ Si vous repr√©sentez l'EPITA et souhaitez le retrait de contenus, contactez-nous imm√©diatement
                </p>
            </div>
            <p>
                Le code source du site est disponible sous licence open-source sur 
                <a href="https://github.com/realone852147/epimap-secours" target="_blank">GitHub</a>.
            </p>

            <h2>5. ‚ö†Ô∏è Limitation de responsabilit√©</h2>
            <p>Les plans et informations fournis le sont <strong>√† titre indicatif</strong>. Nous ne garantissons pas :</p>
            <ul>
                <li>L'exactitude totale des plans (des modifications de campus peuvent survenir)</li>
                <li>La disponibilit√© permanente du service</li>
                <li>L'absence d'erreurs ou d'interruptions</li>
            </ul>
            <p>Les utilisateurs sont invit√©s √† v√©rifier les informations en cas de doute.</p>

            <h2>6. üìû Contact</h2>
            <p>
                Pour toute question, suggestion ou demande concernant le site :<br>
                üìß Responsable : <a href="mailto:mateo.schwab@epita.fr">mateo.schwab@epita.fr</a><br>
                üìß D√©veloppeur : <a href="mailto:nathan.chevalier@epita.fr">nathan.chevalier@epita.fr</a><br>
                üíª <a href="https://github.com/realone852147/epimap-secours" target="_blank">GitHub - Epita-Map</a>
            </p>

            <h2>7. üá´üá∑ Droit applicable</h2>
            <p>
                Les pr√©sentes mentions l√©gales sont soumises au droit fran√ßais. 
                En cas de litige, les tribunaux fran√ßais seront seuls comp√©tents.
            </p>

            <p><em>Derni√®re mise √† jour : Octobre 2024</em></p>

            <button class="btn-back" id="close-legal">‚Üê Retour √† la carte</button>
        </div>
    `
};

// Show Legal Pages
function showLegalPage(type) {
    const container = document.getElementById('container');
    const elements = document.querySelectorAll('header, #btn-settings, #info-menu, #nav-menu, #settings, #map-label, footer');
    
    // Hide all elements
    elements.forEach(el => el.style.display = 'none');
    
    // Show legal content
    container.innerHTML = legalPages[type];
    container.style.background = '#f5f5f5';
    container.style.padding = '0';
    container.style.overflow = 'auto';
    
    // Add close button handler
    document.getElementById('close-legal').addEventListener('click', () => {
        elements.forEach(el => el.style.display = '');
        container.innerHTML = `
            <div style="text-align: center; padding: 2rem;">
                <div class="loading"></div>
                <p style="margin-top: 1rem;">Chargement de la carte...</p>
                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">S√©lectionnez un √©tage dans le menu</p>
            </div>
        `;
        container.style.background = '';
        container.style.padding = '';
        
        // Reload default map
        const defaultMap = 'maps/kb.svg';
        const loadMapFunc = window.loadMapFunction;
        if (loadMapFunc) {
            loadMapFunc(defaultMap);
        }
    });
}

// Add event listeners for legal links
document.addEventListener('DOMContentLoaded', () => {
    const privacyLinks = ['privacy-link', 'settings-privacy-link', 'footer-privacy-link'];
    const mentionsLinks = ['mentions-link', 'footer-mentions-link'];
    
    privacyLinks.forEach(id => {
        const link = document.getElementById(id);
        if (link) {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                showLegalPage('privacy');
            });
        }
    });
    
    mentionsLinks.forEach(id => {
        const link = document.getElementById(id);
        if (link) {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                showLegalPage('mentions');
            });
        }
    });
});
</script>

</body>
</html>
